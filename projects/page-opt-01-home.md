# 页面优化方案 #1 — 首页/仪表板 (Home.vue)

## 📌 当前状态分析

### 现有功能
- 欢迎横幅 + 搜索框
- 4 个统计卡片（文档总数、分类数量、下载次数、用户数量）
- 文档分类入口（2列网格）
- 最近上传列表（最多5条）

### 现有问题
1. 统计维度太少 — 只有4个基础数字，缺少趋势和分析
2. 无数据可视化 — 纯数字展示，没有图表
3. 分类入口缺少数据 — 只有名称和文档数，无法一目了然了解分布
4. 最近上传太简单 — 只有标题+作者+日期，缺少状态、学院等关键信息
5. 无快捷操作 — 管理员没有快速入口处理待办事项
6. 无学院维度 — 高校系统核心应以学院为维度展示数据

---

## ✅ 优化方案

### 一、统计卡片扩充（4 → 8）

**现有保留：**
- 📄 文档总数
- 📁 分类数量
- ⬇️ 下载次数
- 👥 用户数量

**新增：**
- 🏫 学院数量（`stats.total_colleges`）
- 📤 本月上传（`stats.monthly_uploads`）— 展示本月新增文档数，体现系统活跃度
- ⏳ 待审核（`stats.pending_reviews`）— 管理员快速感知待处理任务
- 💾 存储用量（`stats.storage_used`）— 如 "12.5 GB / 50 GB"

**布局调整：**
- 第一行 4 个核心指标（文档、学院、用户、存储）
- 第二行 4 个运营指标（分类、下载、本月上传、待审核）
- 每个卡片增加 **趋势标识**（↑12% 或 ↓5%，对比上月）

### 二、数据可视化区域（新增）

**2.1 文档上传趋势图**
- 折线图/柱状图，展示近 12 个月的上传数量
- 可按学院/分类筛选
- 使用 ECharts（项目已引入）

**2.2 学院文档分布**
- 饼图/环形图，展示各学院的文档占比
- 点击学院可跳转到对应筛选

**2.3 文档类型占比**
- 小型环形图，展示 PDF/Word/PPT 的比例

### 三、"最近上传" 升级为 "动态面板"

**现有：** 只展示最近5条文档标题

**优化为 Tab 面板：**
- Tab 1: 📄 最近上传（增加学院、状态标签、处理状态）
- Tab 2: ⏳ 待审核（管理员可见，直接操作通过/拒绝）
- Tab 3: 🔥 热门文档（按下载量排序的 Top 5）

每条记录增加字段：
- 学院名称
- 处理状态 tag（pending/completed）
- 审核状态 tag（如有）
- 文件大小

### 四、分类入口优化

**现有：** 2列网格，只有图标+名称+数量

**优化：**
- 支持展开子分类（当前已有树形结构但首页未展示）
- 每个分类增加进度条，展示占总文档的比例
- 颜色编码区分不同分类
- 增加"最近更新时间"

### 五、快捷操作区（新增，管理员可见）

管理员首页增加：
- 📤 快速上传按钮
- ⏳ 待审核数量 badge，点击跳转
- 👥 新用户申请提醒
- 🔔 系统通知摘要

---

## 🔧 后端改动

### API: `GET /stats/home` 扩展

```python
# 新增返回字段
{
    "total_documents": 156,
    "total_categories": 12,
    "total_downloads": 1024,
    "total_users": 45,
    # --- 新增 ---
    "total_colleges": 8,
    "monthly_uploads": 23,
    "pending_reviews": 5,
    "storage_used_bytes": 13421772800,  # 12.5 GB
    "storage_total_bytes": 53687091200,  # 50 GB
    "monthly_growth_rate": 0.12,  # 上月对比 +12%
}
```

### 新增 API: `GET /stats/trends`

```python
# 文档上传趋势（近12个月）
{
    "monthly_uploads": [
        {"month": "2025-03", "count": 15},
        {"month": "2025-04", "count": 22},
        ...
    ],
    "college_distribution": [
        {"college_name": "计算机学院", "count": 45},
        {"college_name": "经管学院", "count": 32},
        ...
    ],
    "type_distribution": [
        {"file_type": "pdf", "count": 89},
        {"file_type": "docx", "count": 45},
        {"file_type": "pptx", "count": 22},
    ]
}
```

### 新增 API: `GET /stats/hot-documents`

```python
# 热门文档 Top 5（按下载量）
[
    {"id": "...", "title": "...", "download_count": 156, "college_name": "...", "file_type": "pdf"},
    ...
]
```

### 后端文件改动清单
| 文件 | 改动 |
|------|------|
| `backend/app/api/v1/stats.py` | 扩展 `/stats/home`，新增 `/stats/trends`、`/stats/hot-documents` |
| `backend/app/services/minio.py` | 新增 `get_storage_usage()` 方法 |

---

## 🎨 前端改动

### 文件改动清单
| 文件 | 改动 |
|------|------|
| `frontend/src/views/Home.vue` | 重构整个页面布局 |
| `frontend/src/types/index.ts` | 新增 `HomeStats`、`TrendData` 类型 |

### 布局草案
```
┌──────────────────────────────────────────┐
│  欢迎横幅 + 搜索框（保留现有）             │
├──────────┬──────────┬──────────┬─────────┤
│ 📄文档   │ 🏫学院   │ 👥用户   │ 💾存储  │  ← 核心指标
├──────────┼──────────┼──────────┼─────────┤
│ 📁分类   │ ⬇️下载   │ 📤本月   │ ⏳待审  │  ← 运营指标
├────────────────────┬────────────────────-┤
│  📈 上传趋势图      │  🏫 学院文档分布     │  ← 图表区
│  (ECharts 折线图)   │  (ECharts 饼图)      │
├────────────────────┴─────────────────────┤
│  [最近上传] [待审核] [热门文档]  ← Tab 面板 │
│  文档列表（增强版，含学院+状态）            │
├──────────────────────────────────────────┤
│  分类入口（优化版，含进度条+子分类）        │
└──────────────────────────────────────────┘
```

---

## 📊 工作量评估
- 后端: ~2小时（stats API 扩展 + MinIO 存储查询）
- 前端: ~4小时（ECharts 图表 + Tab 面板 + 布局重构）
- 测试: ~1小时
- **总计: ~7小时**

## ⚠️ 依赖
- ECharts（项目已有，确认版本）
- MinIO SDK 的 bucket 存储用量 API

---
*方案 by powerA ⚡ | 2026-02-09*
